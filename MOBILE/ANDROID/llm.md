# Synapse Android — Документация для LLM

## Start here (5 минут)
- Прочитай “Коротко про продукт” ниже и мини‑глоссарий/лимиты — это словарь проекта.
- Для конкретной задачи заполни/смотри: [`llm_current_task.md`](llm_current_task.md) (цель, DoD, затронутые файлы).
- Быстрые маршруты:
  - UI/экраны/переходы: [`llm_navigation.md`](llm_navigation.md)
  - UI‑компоненты: [`llm_components.md`](llm_components.md)
  - LumControl слой: [`llm_lumcontrol.md`](llm_lumcontrol.md)
  - Pixso tokens: [`llm_tokens.md`](llm_tokens.md)
  - Иконки: [`llm_ico_convert.md`](llm_ico_convert.md)
  - AI‑слой: [`llm_ai_layer.md`](llm_ai_layer.md) (только по явной команде)

## Коротко про продукт (АПК) и Android‑приложение
**Synapse (АПК)** — аппаратно‑программный комплекс для пуско‑наладки, настройки и управления освещением по стандарту **DALI**. В составе: **контроллер** (работает с DALI‑линией и устройствами: светильники/датчики/кнопочные панели) и один или несколько **телефонов** с приложением‑интерфейсом. Телефон подключается к контроллеру по **Bluetooth**. Система поддерживает ручное управление (сцены, яркость/цвет/температура — если поддерживается устройством), а также автоматическую работу по **датчикам** и **расписанию**; для пользователя важны понятия **локаций**, **групп**, **сцен** и режима **АВТО**.

**Мобильное приложение (Android)** — основной инструмент для **ПНР** и настройки: инициализация/расширение линии, распределение устройств по локациям, создание групп, привязки датчиков и кнопок, параметры устройств, расписание, обновление прошивки контроллера, PIN‑доступ и настройки приложения. Дополнительно приложение даёт оперативное управление и включает AI‑слой (панель/чат/микрофон) для помощи пользователю и ускорения типовых действий.

## Мини‑глоссарий и лимиты (из PRD)
- Источник истины по домену/ограничениям: `PRD/SynapsePRD.md`
- **Локация**: “комната/зона” внутри одного контроллера, иерархии нет. До **16**.
- **Группа**: DALI‑группа для совместного управления. Всего до **16** (включая все локации + корень). Светильник в группе — максимум в **1** группе.
- **Сцены**: DALI‑сцены. Сквозные сцены **0–4** (“Выкл…Вкл”).
- **АВТО**: автоматическая логика по датчикам/расписанию. Есть флаг **контроллера** (главный) и флаги **локаций**.
- **Линия DALI**: до **64** устройств (светильники/датчики/кнопки).

## Быстрый старт разработки (точные команды)
Из папки `MOBILE/ANDROID`:
- Сборка debug APK: `.\gradlew.bat :app:assembleDebug`
- (Опционально) установить на подключённое устройство: `.\gradlew.bat :app:installDebug`

## Карта кода (куда смотреть сначала)
- **Точки входа**: `app/src/main/java/com/awada/synapse/activities/MainActivity.kt`, `.../SplashActivity.kt`
- **Экраны**: `.../pages/*` (например `PageLocations.kt`, `PageLocation.kt`, `PageSettings.kt`, `PagePassword.kt`)
- **Компоненты UI**: `.../components/*`
- **LumControl слой**: `.../lumcontrol/*`
- **AI слой**: `.../ai/*` (см. правило ниже)
- **Данные/настройки/каталоги**: `.../data/*`, `.../db/*`
- **Тема/токены**: `.../ui/theme/*`

## Быстрые “рецепты” (типовые задачи)
Смотри [`llm_playbooks.md`](llm_playbooks.md): иконки, токены, новый экран, правки навигации/анимаций, правила безопасных изменений.

## Общие правила
- **НЕ ТРОГАЕМ СЛОЙ AI БЕЗ ЗАПРОСА У ПОЛЬЗОВАТЕЛЯ!!! ЗАПРОС В ЧАТЕ ДОЛЖЕН БЫТЬ КАПСЛОКОМ!!!**
- Растровые изображения брать из `IMG/`
- Векторные изображения (SVG/иконки/логотипы) вытягивать по MCP из Pixso
- Вопросы задавать с пронумерованными вариантами ответов (1, 2, 3...)

## Naming conventions (единый принцип именования)
- **Файл ↔ главный символ**: имя `.kt` совпадает с главным `@Composable fun` или `class/data class/object` в файле.
- **Pages (экраны)**: `Page{Entity}{Suffix}`
  - список: `Page{Entities}` (plural), детали: `Page{Entity}` (singular)
  - настройки: `Page{Entity}Settings`
  - действия: `Page{Action}` (Search, Password, IconSelect)
- **Components (UI)**: существительное + суффикс типа (`*Button`, `*Icon`, `*Indicator`, `*Field`), без опечаток и неясных суффиксов.
- **Acronyms**: пишем **UPPERCASE** в именах типов/файлов (`AIChat`, `AIMessageEntity`, `UIMessageAI`).

## Разделы документации

### [Текущая задача (шаблон)](llm_current_task.md)
Заполняется под конкретный запрос: цель, ограничения, DoD, затронутые файлы, проверка.

### [Playbooks: рецепты типовых задач](llm_playbooks.md)
Короткие инструкции “куда смотреть → что править → как проверить” для экранов, токенов, иконок, LumControl, данных.

### [Токены Pixso](llm_tokens.md)
Цвета, размеры, строки, типографика. Синхронизация токенов из Pixso, маппинг ID → Kotlin, иерархия базовых токенов и алиасов.

### [UI Компоненты](llm_components.md)
Готовые компоненты: кнопки (Keyboard, Pin, Primary, Secondary), Tooltip, Toggle, FabButton, AppBar, PageContainer.

### [AI Панель](llm_ai_layer.md)
Нижняя панель с тумблерами и FAB (AIMain), чат bottom sheet (AIChat), контейнер AI, gesture логика.

### [Навигация и Экраны](llm_navigation.md)
Экраны приложения (PageLocation, PageSettings, PagePassword), навигация через AnimatedContent, MainActivity setup.

### [LumControl Layer](llm_lumcontrol.md)
Компонент управления освещением между слоем страниц и AI. Раздвигаемый контейнер с ручкой, слайдеры и кнопки сцен.

### [Pixso Workflow](llm_pixso_workflow.md)
Работа с дизайном: получение структуры (getNodeDSL), семантические токены, экспорт иконок.

### [Структура проекта](llm_project_structure.md)
Package структура, список иконок в `res/drawable/`.

### [Конвертация иконок](llm_ico_convert.md)
Экспорт SVG из Pixso, конвертация в Android Vector Drawable, JSON каталог иконок, использование в коде (фильтрация, поиск, Compose компоненты).
