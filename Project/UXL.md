# User Experience Language (UXL)

Язык описания интерфейсов для UX-дизайна в Markdown-файлах.  
Используется для последующего рендеринга в HTML/SVG в браузере.

## Быстрый старт

### 1) Вставь UXL-блок в HTML

Минимальный шаблон:

```html
<link rel="stylesheet" href="./uxl.css" />
<pre class="uxl-md-block">```UXL
...тут UXL...
```</pre>
<script src="./uxl.js"></script>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    window.UXL.renderAll({ selector: "pre.uxl-md-block", mode: "permissive" });
  });
</script>
```

### 2) Полный пример (по одному экземпляру каждого тега)

В примере есть: `P`, `F`, `C`, `B`, `T`, `TH`, `TD` (и `GOTO` между страницами).

````text
```UXL
400x700
P\home\Главная страница\IN:M16\Хинт страницы (показывается без линии отводки)
  F\100%x100%\OUT:LT\IN:M12\Хинт контейнера
    C\Заголовок\x40\OUT:LT:M4\IN:M6\Хинт надписи
    B\Перейти на users\ICON:chevron-right\OUT:RB:M6\140x32\IN:M8\GOTO:users\Хинт кнопки (переход)
    T\COLS:20R,50L,30\100%x60%\OUT:B:M10\IN:M6\Хинт таблицы
      TH\ID\ФИО\Роль
      TD\1\Алексей\Админ
P\users\Пользователи\Хинт второй страницы
  C\Вы на странице users\x20\OUT:T:M4\IN:M6\Хинт надписи на второй странице
  B\Назад на home\ICON:back\OUT:L:M6\120x32\IN:M8\GOTO:home\Хинт кнопки назад
```
````

## Структура UXL-блока в MD-файле

Начало блока UXL: ` ```UXL`  
Окончание блока UXL: ` ``` `

### Значимые строки

- Пустые строки игнорируются.
- Комментарии игнорируются: строка, у которой после отступов первый символ `#`.

### Отступы и вложенность

- Вложенность задаётся отступами.
- Каждый уровень вложенности добавляет **ровно два пробела**.
- Табы запрещены.
- “Перескок” глубже больше чем на 1 уровень за строку — ошибка.

### Размер окна блока (опционально)

Первая значимая строка после ` ```UXL` может задавать размер окна:

- Формат: `WxH` (например, `600x600`)
- `W` и `H` — целые числа, `> 0`
- Суффикс `px` писать нельзя

> Примечание: в текущей реализации допускаются суффиксы переполнения для окна (см. `SIZE`): `600Cx600S`.

Поведение при выходе содержимого за границы окна:

- По умолчанию содержимое страницы **скроллится при необходимости** внутри окна (как `S`).
- Полосы прокрутки **не должны уменьшать рабочее поле**: размер окна `WxH` — это размер рабочей области, а скроллбары добавляются “снаружи”.
- Суффиксы `C/S` для окна позволяют принудительно задать crop/scroll по оси.

Если первой значимой строки с размером нет — размер окна по умолчанию `500x500`.

После опциональной строки размера окна в корне блока разрешены **только теги `P`**.

## Режимы парсинга (strict / permissive)

- **strict** — любое нарушение спецификации является ошибкой, блок не рендерится.
- **permissive** — некоторые нарушения допускаются/нормализуются (если это оговорено отдельно).

## Разделитель полей и правила текста

- Символ `\` является разделителем полей.
- Завершающий `\` допускается и игнорируется (как будто его нет).
- После снятия отступа вложенности строка триммится по краям; затем каждое поле триммится по краям.
- Поля `CAPTION`, `HINT` (и текст ячеек `TH/TD`) могут быть:
  - некавычечными: любая строка без `\` (пробелы допустимы);
  - кавычечными: `"..."` — внутри допускаются `\"` и `\\`.
- В некавычечной форме символ `\` запрещён. Если нужен `\` — используйте кавычечную форму.

## SIZE — размеры элемента

Поле `SIZE` задаётся как `WxH`.  
Каждая ось (`W` или `H`) задаётся по шаблону: `число[%][C|S]`

- **Пиксели**: целое число без суффикса (например `330`), `px` запрещён.
- **Проценты**: целое число `0..100%` (например `33%`) — процент берётся от внутреннего размера контейнера-родителя по соответствующей оси.
  - **Важно**: проценты считаются **не от всего размера родителя**, а от **свободного места** по оси:
    - в пределах соответствующей зоны размещения (`T` / центр / `B`) внутри родителя (`P`/`F`)
      - для высоты (`x30%`) зона **центр** означает область **между** top (`T`) и bottom (`B`) элементами
    - из доступного размера вычитаются итоговые размеры **всех остальных sibling‑элементов** этой зоны (включая их `M`)
    - если `%`‑элементов несколько — остаток делится **пропорционально их процентам** (порядок в UXL не влияет)
    - если остаток < 0 — считается 0
- Допускаются частичные формы: `Wx`, `xH`, `W%x`, `xH%` (неуказанная ось — intrinsic).

### Переполнение по оси (crop/scroll)

После размера (и после `%`, если он указан) можно добавить суффикс:

- `C` (crop) — обрезать переполнение (без прокрутки)
- `S` (scroll) — прокрутка по этой оси

Если суффикса нет — по умолчанию элемент **раздвигается**, если контент больше заданного размера.

## ALIGN — выравнивание элемента

Выравнивание и внешний отступ задаются токеном вида `OUT:<ALIGN>[:M<number>]` (например `OUT:LT:M8`).
`OUT:<ALIGN>` задаёт выравнивание по горизонтали и вертикали относительно контейнера-родителя.

Дополнительно для контейнеров (`P` и `F`) можно задать **групповое выравнивание детей по умолчанию**:

- `IN:<ALIGN>` (например `IN:LT`) — если у дочернего элемента не задан `OUT:<...>`, то он будет размещён внутри контейнера согласно `IN:<ALIGN>`.
- `IN:H` или `IN:V` — режим “выстраивания” детей с одинаковыми якорями (одинаковый `OUT:<ALIGN>`):
  - `IN:H`: выстраивать **горизонтально**
  - `IN:V`: выстраивать **вертикально**

Для не‑контейнеров (`B`, `C`, `T`) `IN:L` / `IN:C` / `IN:R` означает **выравнивание контента внутри элемента** (текст/иконка/ячейки), а не про детей.

- Горизонталь: `L` (влево), `R` (вправо) или `C` (center), если не указано — по центру.
- Вертикаль: `T` (вверх), `B` (вниз) или `M` (middle), если не указано — по центру.
- Комбинации по одной оси запрещены: `L/R/C` — только одно; `T/B/M` — только одно.

Допустимые комбинации: `OUT:LT`, `OUT:LB`, `OUT:RT`, `OUT:RB`, `OUT:L`, `OUT:R`, `OUT:T`, `OUT:B`, `OUT:C`, `OUT:M`, `OUT:CM` (и любая из них может иметь суффикс `:M<number>`). Пусто — центр.

## ACTION

Поддерживаемая команда:

- `GOTO:<ID>` — переход на страницу `P` с указанным `ID` (case-insensitive).
- Для обратной совместимости допускается старая форма `GOTO:P<ID>` и трактуется как `GOTO:<ID>`.
- `GOTOBACK` — переход “назад” по истории навигации (возврат на предыдущую страницу). Работает в прототипе и в основном рендере (клики в рамках одного UXL-блока).

## Отступы: OUT (margin) и IN (padding)

Отступы — целые числа в пикселях, **одно значение на все стороны**:

- `OUT:...:M<number>` — **margin** (внешний отступ, влияет на layout)
- `IN:M<number>` — **padding** (внутренний отступ, влияет на layout)

Отдельные токены **запрещены** и должны выдавать ошибку:

- `M<number>` (без `OUT:`)
- `P<number>` (старый padding)

Правила:

- Значения: целые `>= 0`
- По умолчанию:
  - `C`: `OUT:...:M3`, `IN:M5`
  - `B`: `OUT:...:M3`, `IN:M5`
  - `T`: `IN:M5` (padding ячеек `TH/TD`)
  - остальные случаи: `OUT:...:M0`, `IN:M0`
- Размеры `SIZE` считаются как **border-box**: padding “внутри” заданного размера.

Где используются:

- `P` — `IN:M<number>` (padding страницы)
- `F` — `IN:M<number>` (padding контейнера)
- `C`, `B` — `OUT:...:M<number>` (margin) и `IN:M<number>` (padding)
- `T` — `OUT:...:M<number>` (margin таблицы) и `IN:M<number>` (**padding ячеек `TH/TD`**)

## ID

- ID используется **только у `P`** и **необязателен**.
- Если `GOTO` указывает на страницу — у целевой страницы должен быть задан `ID`.
- Формат ID: латиница/цифры/`_`/`-`, может начинаться с цифры, сравнение case-insensitive.

## Теги

Ниже — разрешённые теги, их вложенность и форматы строк.

### P — Страница

- **В корне блока** разрешены только `P`.
- `P` не может быть вложенным элементом.
- Дочерние теги: `F`, `B`, `C`, `T`.

Формат:

- `P\CAPTION[\...поля...]` (страница без ID)
- `P\ID\CAPTION[\...поля...]` (страница с ID — нужно для `GOTO`)

Поддерживаемые поля (в любом порядке):

- `IN:M<number>` — padding страницы
- `GOTOAFTER:<seconds>` — авто‑переход на **следующую страницу** через указанное количество секунд (например `GOTOAFTER:3` или `GOTOAFTER:1.5`). **Срабатывает только в просмотре прототипа (1:1 / Full Screen)**.
- `TYPE:G:NEW` — метки типа (можно указывать несколько через `:`):
  - `G` — “глобальная” страница для карты интерфейса:
    - в **карте интерфейса** ставится отдельным списком **внизу** и считается **без связей** (стрелки к/от неё не рисуются)
    - на рендер/прототип (GOTO/GOTOBACK) это поле **не влияет**
  - `NEW` — бейдж `new` в правом нижнем углу (24x24) у элементов; на плитке карты и на canvas страницы появляется, если у `P` или любого дочернего элемента есть `TYPE:NEW`
  - Примеры: `TYPE:G:NEW`, `TYPE:G`, `TYPE:NEW`
- `HINT` — подсказка страницы

Если `ID` не указан, то запись `P\CAPTION\HINT` допустима: второе поле трактуется как `CAPTION`, третье — как `HINT`.

Пример (все поля):

- `P\users\Главная страница\IN:M16\Подсказка страницы`

Подпись в рендере:

- если `CAPTION` пустой → показываем `P`
- если `CAPTION` пустой и есть `ID` → `P <ID>`

### F — Контейнер (layout)

- Визуально не рисуется (служит для раскладки).
- Может содержать: `F`, `B`, `C`, `T`, `I`.

Формат:

- `F[\\...поля...]`

Поля могут идти **в любом порядке** (как у `B`), кроме `ACTION` (не используется).
Поддерживаются: `SIZE`, `ALIGN`, `OUT:<ALIGN>[:M<number>]`, `IN:M<number>`, `IN:<ALIGN>`, `IN:H|IN:V`, `IN:L|IN:C|IN:R`, `HINT`.
Дополнительно (опционально): `#RRGGBB` — цвет фона контейнера.
Дополнительно (опционально): `BG:"<url>"` — фон контейнера картинкой по адресу (растровый URL).  
Рендер: `center / cover / no-repeat`.

Пример (все поля):

- `F\100%x80%\T\IN:M12\BG:"src/yarmap.PNG"\Подсказка контейнера`

### I — Картинка

- Дочерние элементы запрещены.

Формат:

- `I\SRC:"<url>"[\...поля...]`
- `I\<iconName>[\...поля...]` — если вместо пути указано имя встроенной иконки (как у кнопок), рисуется SVG-иконка
- `I\SRC:<iconName>[\...поля...]` — то же самое (если `SRC` выглядит как “голое” имя без пути/расширения)

Поля после `SRC:` (или после имени иконки) могут идти **в любом порядке** и распознаются по виду:

- `SRC:"<url>"`: путь/URL к растровой картинке (например `SRC:"src/yarmap.PNG"`)
  - если вместо URL указано имя встроенной иконки — будет нарисована SVG-иконка
- `SIZE`: содержит `x` (например `200x120`, `200x`, `x120`)
  - если `SIZE` не задан — берутся `naturalWidth/naturalHeight` картинки
  - если задано частично (`200x` или `x120`) — вторая ось считается по пропорциям картинки
- `ALIGN`: содержит только `L/R/T/B` (без `LR` и `TB`)
- `#RRGGBB`: цвет (для встроенной иконки — цвет пиктограммы)
- `FIT`: вписать картинку в заданный `SIZE` (сохраняя пропорции)
- `CROP`: заполнить `SIZE` (сохраняя пропорции, обрезая лишнее)
- если ни `FIT`, ни `CROP` **не указаны** — **без масштабирования** (картинка центрируется и обрезается по границам элемента)
- `ICON:NAME[:SIZE]`: для режима со встроенной иконкой можно задать размер в px (для `I` диапазон **8..256**)
- `ACTION`: начинается с `GOTO:` — кликабельная “графическая кнопка” (переход как у `B`)
- `M<number>`: margin картинки
- `R<number>`: скругление углов картинки (border-radius), px
- всё остальное — `HINT`

Пример (все поля):

- `I\SRC:"src/yarmap.PNG"\200x120\OUT:LT:M6\FIT\Подсказка картинки`
- `I\SRC:"src/yarmap.PNG"\200x120\OUT:LT:M6\FIT\R12\Подсказка картинки`

### B — Кнопка

- Дочерние элементы запрещены.

Формат:

- `B\CAPTION[\...поля...]`
- `B\ICON:NAME[:SIZE][\...поля...]` (кнопка без текста, только иконка)

Поля после `CAPTION` могут идти **в любом порядке** и распознаются по виду:

- `SIZE`: содержит `x` (например `100x`, `x20`, `50%x30%`, `100Cx`)
- `ALIGN`: содержит только `L/R/T/B` (без `LR` и `TB`)
- `ACTION`: начинается с `GOTO:`
- `#RRGGBB`: цвет (текст и встроенная иконка)
- `ICON:NAME`: встроенная пиктограмма слева от текста (без внешних файлов)
  - доступные `NAME`: `ai`, `arrow-left`, `arrow-right`, `back`, `box`, `check`, `chevron-left`, `chevron-right`, `clock`, `close`, `codepen`, `cpu`, `delete`, `edit`, `grid`, `grid1x1`, `grid3x3`, `grid4x4`, `home`, `loader`, `menu`, `microphone`, `more-horizontal`, `new`, `plus`, `search`, `sliders`, `sun`, `settings`, `trash`, `volume-2`, `volume-x`
  - опционально можно задать размер в px: `ICON:search:18` (диапазон 8..48)
- `OUT:...:M<number>`: margin кнопки
- `IN:M<number>`: padding кнопки
- `R<number>`: скругление углов кнопки (border-radius), px
- `IN:...:W` / `IN:...:NW`: перенос текста (wrap) внутри элемента
  - пример: `IN:M8:NW` или `IN:NW:M8`
  - `W` (по умолчанию): перенос строк разрешён, длинные слова можно переносить
  - `NW`: перенос запрещён, длинный текст обрезается с `...`
- всё остальное — `HINT`
- Пример: `B\Кнопка`
- Пример (иконка‑только): `B\ICON:home`

#### Встроенные иконки для `B` (полный список)

Имена (для поля `ICON:...`):

- `ai`
- `arrow-left`
- `arrow-right`
- `back`
- `box`
- `check`
- `chevron-left`
- `chevron-right`
- `clock`
- `close`
- `codepen`
- `cpu`
- `delete`
- `edit`
- `grid`
- `home`
- `menu`
- `microphone`
- `more-horizontal`
- `new`
- `plus`
- `search`
- `sun`
- `settings`
- `trash`
- `volume-2`

Быстрые примеры (копипаст):

````text
```UXL
300x220
P\icons\ICON names
  F\100%x100%\OUT:LT\IN:M10
    B\ai\ICON:ai\120x28\OUT:LT
    B\arrow-left\ICON:arrow-left\120x28\OUT:LT
    B\arrow-right\ICON:arrow-right\120x28\OUT:LT
    B\back\ICON:back\120x28\OUT:LT
    B\box\ICON:box\120x28\OUT:LT
    B\chevron-left\ICON:chevron-left\120x28\OUT:LT
    B\chevron-right\ICON:chevron-right\120x28\OUT:LT
    B\close\ICON:close\120x28\OUT:LT
    B\codepen\ICON:codepen\120x28\OUT:LT
    B\cpu\ICON:cpu\120x28\OUT:LT
    B\edit\ICON:edit\120x28\OUT:LT
    B\grid\ICON:grid\120x28\OUT:LT
    B\home\ICON:home\120x28\OUT:LT
    B\microphone\ICON:microphone\120x28\OUT:LT
    B\plus\ICON:plus\120x28\OUT:LT
    B\search\ICON:search\120x28\OUT:LT
    B\sun\ICON:sun\120x28\OUT:LT
    B\settings\ICON:settings\120x28\OUT:LT
    B\trash\ICON:trash\120x28\OUT:LT
    B\volume-2\ICON:volume-2\120x28\OUT:LT
```
````

Пример (все поля):

- `B\Перейти\ICON:search\OUT:RB:M6\140x32\IN:M8\R8\GOTO:users\Открыть страницу users`
- `B\Перейти\ICON:search:18\OUT:RB:M6\140x32\IN:M8\R8\GOTO:users\Открыть страницу users`

### S — Переключатель (тумблер)

Горизонтальный переключатель из **2+ вариантов**.

Формат:

- `S\VALUE\OPT\OPT...[ \...поля... ]`

Где:

- `VALUE` — выбранный вариант как **индекс** `0..N-1`
- `OPT` — варианты (минимум 2), каждый вариант может быть:
  - пустым (две `\\` подряд)
  - текстом
  - иконкой: `ICON:<name>[:size]`

Поддерживаемые поля (в любом порядке):

- `SIZE`
- `OUT:<ALIGN>[:M<number>]`
- `IN:M<number>` — padding
- `IN:...:W` / `IN:...:NW` — перенос текста внутри сегментов (как у `B/C`)
- `HINT`

Поведение:

- Клик по **сегменту** выбирает сегмент.
- Можно повесить переход на конкретный сегмент, добавив к варианту суффикс:
  - `OPT@GOTO:<pageId>`
  - `OPT@GOTOBACK`
  - Для пустого варианта можно писать просто `@GOTO:<pageId>` / `@GOTOBACK` (без текста/иконки).

### C — Надпись

- Дочерние элементы запрещены.

Формат:

- `C\CAPTION[\...поля...]`

Поля после `CAPTION` могут идти **в любом порядке** (как у `B`).

Дополнительно:

- `#RRGGBB`: цвет текста
- `FONT:<sizePx>[:BI]`: шрифт надписи (`sizePx` — целое > 0 в px; флаги `B`=bold, `I`=italic, порядок любой; можно без флагов)
  - `FONT` влияет **только на шрифт**, `SIZE` (`x20`) остаётся про размеры блока; оба поля можно указывать вместе
  - неверный формат `FONT` — ошибка (и в strict, и в permissive)
- `IN:...:W` / `IN:...:NW`: перенос текста
  - пример: `IN:M0:NW`
  - `W` (по умолчанию): перенос строк разрешён, длинные слова можно переносить
  - `NW`: перенос запрещён, длинный текст обрезается с `...`

> Примечание: ACTION для `C` по смыслу не нужен, но поле допускается как позиция в строке.

Пример (все поля):

- `C\Текст\x20\OUT:LT:M4\IN:M6\GOTO:users\Подсказка`

### T — Таблица (контейнер для TH/TD)

- Может содержать только: `TH`, `TD`.
- Порядок: `TH` (0 или 1 раз), затем `TD` (0+ раз).

Формат:

- `T[\\...поля...]`

Поля могут идти **в любом порядке** (как у `B`).

Дополнительно:

- `#RRGGBB`: цвет текста ячеек (TH/TD)
- `IN:...:W` / `IN:...:NW`: перенос текста в ячейках
  - если указано в `T` — применяется ко всем `TH/TD` внутри
  - если указано в конкретном `TH`/`TD` — переопределяет настройку `T` для этой строки
  - в `TH/TD` допускается `IN:M<number>:...` как локальный padding ячеек для этой строки

Пример (все поля):

- `T\COLS:20R,50L,30\100%x60%\OUT:T:M10\IN:M6\Подсказка таблицы`

Колонки задаются в поле `COLS:...` (обязательно):

- формат: `COLS:20R,50L,30`
- где `20/50/30` — ширины колонок в %, суффикс `L`/`R` задаёт выравнивание текста в колонке (если не указан — центр)
- сумма процентов нормализуется до 100 (детерминированно)

ACTION для `T` не поддерживается:

- strict: ошибка
- permissive: игнор

### TH — Заголовок таблицы

Формат:

- `TH\C\C\C\...[ \W | \NW | \IN:... ]`

Количество ячеек должно соответствовать количеству колонок, заданному в `T` через `COLS:...`.

Пример:

- `TH\ID\ФИО\Роль`

### TD — Строка данных таблицы

Формат:

- `TD\C\C\C\...[ \W | \NW | \IN:... ]`

Количество ячеек должно соответствовать количеству колонок в `T`.
Пустая ячейка задаётся пустым значением поля (например `TD\\1\\\\100`).

Пример:

- `TD\1\Алексей\Админ`

## Валидация структуры (рекомендуемый strict)

Рекомендуется считать ошибкой и не рендерить блок, если:

- нарушены правила отступов/вложенности;
- в корне встречаются теги, отличные от `P` (после опционального размера окна);
- у `T` отсутствует `COLS:...`, нарушен порядок `TH/TD` или число ячеек не совпадает с количеством колонок;
- `GOTO` ссылается на несуществующую страницу (по `ID`);
- встречаются неизвестные теги или неизвестные команды `ACTION`;
- встречается `ALIGN` с `LR` или `TB`.

## Рендеринг (кратко)

- По умолчанию показывается первая страница в блоке.
- Элементы одного уровня в контейнере **не должны перекрываться**.
- Порядок размещения/прижатия определяется порядком элементов в UXL-коде (см. раздел **Layout** ниже и `UXL_parser_prompt.md`).

## Layout — размеры и выравнивание элементов

> Раньше это было отдельным файлом `UXL_layout.md`. Теперь это часть `UXL.md`, чтобы не было двух источников правды.  
> Примечание: детали форматов `SIZE/ALIGN` выше в документе являются основными; ниже — компактная “модель раскладки”, важная для однозначного рендера.

### SIZE — размеры элемента

Ширина и высота элемента в формате: `WxH` (ШИРИНАxВЫСОТА).

Каждая ось (`W` или `H`) задаётся по шаблону: **`число[%][C|S]`**

#### Единицы измерения

- **Пиксели (по умолчанию)**: целое число без суффикса (например `330`). Суффикс `px` **писать нельзя**.
- **Проценты**: целое число с суффиксом `%` (например `33%`) — процент берётся от внутреннего размера контейнера-родителя по соответствующей оси.

Правила чисел для `SIZE`:
- пиксели: целое число `>= 0`;
- проценты: целое число от `0%` до `100%` включительно;
- дробные значения запрещены; отрицательные значения запрещены.

#### Управление переполнением (crop/scroll)

После размера (и после `%`, если он указан) можно добавить **один** суффикс:
- **`C` (crop)** — если содержимое не помещается в заданный размер по этой оси, оно **обрезается** (без скроллинга).
- **`S` (scroll)** — если содержимое не помещается, появляется **полоса прокрутки** по этой оси.

Суффиксы `C` и `S` **взаимоисключающие** на одной оси. Наличие обоих одновременно (например `100CS` или `100SC`) — **ошибка** в strict-режиме.

**По умолчанию** (без `C` или `S`): если содержимое не помещается в заданный размер, элемент **автоматически раздвигается** до необходимого размера.

**Примеры**:
- `200Cx100` — ширина 200px с обрезкой, высота 100px раздвигается
- `50%Cx30%S` — ширина 50% с обрезкой, высота 30% со скроллом
- `100Cx` — ширина 100px с обрезкой, высота intrinsic (по содержимому)
- `800Cx600S` — для размера окна блока (первая строка после ```UXL)

**Важно**: crop/scroll **требует явного числа** по этой оси. Запись вида `Cx100` (без числа перед `C`) — **ошибка**.

Crop/scroll применяется к **содержимому внутри элемента** (для контейнеров — к дочерним элементам, для `C`-надписи — к тексту, для `T`-таблицы — к строкам/ячейкам).

#### Частичные размеры

Можно указать только ширину (`Wx` или `W%x`), только высоту (`xH` или `xH%`), или не указывать ни того ни другого. Если размер не указан или указан частично, недостающая часть определяется содержимым элемента (intrinsic size).

### ALIGN — выравнивание элемента

Выравнивание по горизонтали и вертикали в пределах элемента-родителя в формате LRTB.

L - привязка к левому краю,  
R - привязка к правому краю,  
Если не указаны ни L ни R, выравнивание по горизонтали по середине.  
**LR** (одновременно L и R) — **запрещено** (ошибка в strict-режиме).

T - привязка к верхнему краю,  
B - привязка к нижнему краю,  
Если не указаны ни T ни B, выравнивание по вертикали по середине.  
**TB** (одновременно T и B) — **запрещено** (ошибка в strict-режиме).

Можно комбинировать горизонтальное и вертикальное выравнивание: LT (левый верхний угол), RB (правый нижний угол), LRTB (растягивание на всю область) и т.д.

### Модель layout (чтобы рендер был однозначным)

- Каждый `P`/`F` образует прямоугольный контейнер (box) со своей внутренней областью.
- `T` (таблица) имеет **свою отдельную модель layout** — см. правила для таблиц.
- Дочерние элементы позиционируются относительно внутренней области контейнера по `SIZE` и `ALIGN`.
- Элементы одного уровня в пределах одного контейнера не должны перекрываться (накладываться друг на друга).
- Порядок вывода элементов в контейнере определяется их порядком в UXL-коде.

#### Правила укладки (stacking)

| Условие | Направление укладки | Порядок |
|---------|---------------------|---------|
| Одинаковое V (T, B, или не указано/центр) | **Вертикальная** | Первый в коде = выше (меньше Y) |
| Одинаковое H (L, R, или не указано/центр) при разном V | **Горизонтальная** | Первый в коде = левее (меньше X) |
| Одинаковое на обеих осях | **Вертикальная** | V имеет приоритет |

- Элементы группируются по вертикальному выравниванию (T / центр / B).
- Внутри каждой группы элементы укладываются **вертикально** сверху вниз в порядке появления в коде.
- Горизонтальное выравнивание (L / центр / R) определяет X-позицию элемента внутри группы.
- Группа T прижата к верхнему краю, группа B — к нижнему, группа "центр" — между ними.

## Пример

```UXL
980x640
P\users\Пользователи и роли — панель администратора
  C\"Список пользователей. Демо-путь: C:\\Temp\"\x20\LT\Это демонстрационный заголовок (подсказка).
  F\100%x85%\T
    F\30%x\L
      C\Фильтры и действия\200x20\LT
      B\Добавить пользователя\180x32\L\GOTO:add_user\Открыть форму добавления нового пользователя
      B\Отчёты и аудит\180x32\L\GOTO:reports\Перейти к отчётам и журналу действий
    F\70%x\R
      T\100%x100%\T\Таблица пользователей (демо)
        TC\12R\48L\20L\20R
        TH\ID\ФИО\Роль\Статус
        TD\1\Алексей Худяков\Администратор\Активен
        TD\2\Ирина Петрова\Оператор\Ожидает
        TD\3\Михаил Сидоров\Аудитор\Заблокирован
      B\Открыть карточку выбранного\240x32\RB\GOTO:add_user\Демо: переход на карточку пользователя
P\add_user\Карточка пользователя — создание/редактирование
  C\Заполните данные пользователя и сохраните изменения\x20\LT\Подсказка: здесь позже появятся поля ввода.
  F\100%x85%\T
    F\60%x\L
      C\ФИО:\x20\LT
      C\Роль:\x20\LT\Подсказка: выбор роли в демо не реализован (макет).
      C\Статус:\x20\LT
      B\Сохранить\140x32\LB\GOTO:users\Вернуться к списку после «сохранения»
    F\40%x\R
      C\"Подсказка: справка по ролям ниже\"\x40\LT
      B\Справка по ролям\180x32\L\GOTO:reports\Открыть справочный раздел (демо)
  B\Назад к списку\160x32\RB\GOTO:users\Вернуться к таблице пользователей
P\reports\Отчёты и журнал действий — аналитика и аудит
  C\Сводка активности и события безопасности\x20\LT\Демонстрационная страница отчётов.
  T\100%x75%\T\Журнал действий (демо)
    TC\20R\30L\30L\20R
    TH\Время\Событие\Пользователь\Код
    TD\10:12\Вход в систему\Алексей\200
    TD\10:16\Создан пользователь\Ирина\201
    TD\10:20\Изменена роль\Михаил\202
  B\Назад к пользователям\190x32\RB\GOTO:users\Вернуться на главную страницу списка
```
