# Прошивка. Логика работы. Настройка

АПК Синапс v1.0. ПО. Спецификации на разработку

**Последнее изменение:** 12.12.2025, 13:19 МСК

## 2. Сохранение световых сцен

2.1. **Сохранение сцены отдельного светильника**:
- Пользователь устанавливает нужную яркость/цвет/температуру светильника;
- Приложение отправляет команду на сохранение сцены N;
- Прошивка отправляет DALI-команду сохранения текущего состояния в сцену N;
- Прошивка обновляет таблицу **SCENE_LUMINAIRES**.

2.2. **Сохранение сцены группы**:
- Пользователь устанавливает нужное состояние светильников группы;
- Приложение отправляет команду на сохранение сцены N для группы i;
- Прошивка отправляет групповую DALI-команду сохранения сцены N;
- Прошивка обновляет **SCENE_LUMINAIRES** для всех светильников группы.

## 3. Формирование и активация расписания

3.1. **Добавление события в расписание**: приложение отправляет телеграмму с заполнением записи **EVENTS[i]**:
- **EXIST** = `T`;
- **DAYS** = маска дней недели (например, 'FFTFFFF' — только вторник);
- **TIME** = время в формате HHMM;
- **SMOOTH** = `T` (плавное изменение) или `F` (одномоментное);
- **ACTION_ID** = `j` (действие для выполнения).

3.2. **Активация расписания**: приложение отправляет телеграмму с изменением **CONTROLLERS.IS_SCHEDULE** = `T`.

3.3. Прошивка начинает проверку событий расписания каждую минуту.

3.4. **Деактивация расписания**: приложение отправляет **CONTROLLERS.IS_SCHEDULE** = `F`.
