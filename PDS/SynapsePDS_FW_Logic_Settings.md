# Прошивка. Логика работы. Настройка

АПК Синапс v1.0. ПО. Спецификации на разработку

**Последнее изменение:** 13.12.2025, 14:04 МСК

## 1. Сохранение световых сцен

1.1. Каждый светильник в таблице **SCENE_LUMINAIRES** имеет пять световых сцен. Эти же сцены записываются в физические светильники DALI.

1.2. Изменения световых сцен присылаются в прошивку в виде одной или нескольких записей таблицы **SCENE_LUMINAIRES**.

## 2. Настройка поддержки освещённости

2.1. Поддержка уровня освещённости производится с помощью датчиков освещённости, привязанных к группам светильников.

2.2. Значение освещённости, которое должно поддерживаться у конкретной сцены конкретной группы, присылается в прошивку изменением поля **BRIGHT_SENSORS.SCENE_BRIGHTNESS_n**, где n — сцена 0..4.

2.3. Если значение **BRIGHT_SENSORS.SCENE_BRIGHTNESS_n** = -1, значит при этой сцене эта группа не нуждается в подстройке уровня освещённости.

## 3. Формирование и активация расписания

3.1. **Добавление события в расписание**: приложение отправляет телеграмму с заполнением записи **EVENTS[i]**:
- **EXIST** = `T`;
- **DAYS** = маска дней недели (например, 'FFTFFFF' — только вторник);
- **TIME** = время в формате HHMM;
- **SMOOTH** = `T` (плавное изменение) или `F` (одномоментное);
- **ACTION_ID** = `j` (действие для выполнения).

3.2. **Активация расписания**: приложение отправляет телеграмму с изменением **CONTROLLERS.IS_SCHEDULE** = `T`.

3.3. Прошивка начинает проверку событий расписания каждую минуту.

3.4. **Деактивация расписания**: приложение отправляет **CONTROLLERS.IS_SCHEDULE** = `F`.
