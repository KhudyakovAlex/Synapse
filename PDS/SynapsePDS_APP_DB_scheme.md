# Схема базы данных приложения

АПК Синапс v1.0. ПО. Спецификации на разработку

**Последнее изменение:** 05.12.2025

```mermaid
erDiagram
    LOCATIONS ||--o| LUMINAIRES : "LOCATION_ID nullable"
    LOCATIONS ||--o| GROUPS : "LOCATION_ID nullable"
    LOCATIONS ||--o| PRES_SENSORS : "LOCATION_ID nullable"
    LOCATIONS ||--o| BRIGHT_SENSORS : "LOCATION_ID nullable"
    LOCATIONS ||--o| BUTTON_PANELS : "LOCATION_ID nullable"
    GROUPS ||--o{ LUMINAIRES : "GROUP_ID"
    GROUPS ||--o{ BRIGHT_SENSORS : "GROUP_ID"
    LUMINAIRES ||--o{ SCENE_LUMINAIRES : "LUMINAIRE_ID"
    BUTTON_PANELS ||--o{ BUTTONS : "BUTTON_PANEL_ID"
    ACTION_SETS ||--o{ BUTTONS : "ACTION_SET_SHORT_ID"
    ACTIONS ||--o{ BUTTONS : "ACTION_LONG_ID"
    ACTIONS ||--o{ PRES_SENSORS : "ACTION_OCCUPANCY_ID"
    ACTIONS ||--o{ PRES_SENSORS : "ACTION_VACANCY_ID"
    ACTION_SETS ||--o{ ACTIONS : "ACTION_SET_ID"
    ACTIONS ||--o{ SUBACTIONS : "ACTION_ID"
    ACTION_SETS ||--o{ EVENTS : "ACTION_SET_ID"

    CONTROLLERS {
        INTEGER ID PK
        INTEGER SCALE
        TEXT NAME
        TEXT PASSWORD
        TEXT IS_SCHEDULE
        TEXT IS_AUTO
        INTEGER ICO_NUM
        TEXT STATUS
        INTEGER SCENE_NUM
    }

    LOCATIONS {
        INTEGER ID PK
        TEXT NAME
        INTEGER ICO_NUM
        INTEGER SCALE
        INTEGER POS_X
        INTEGER POS_Y
        TEXT EXIST
        TEXT IS_AUTO
        INTEGER SCENE_NUM
    }

    GROUPS {
        INTEGER ID PK
        TEXT NAME
        TEXT EXIST
        INTEGER LOCATION_ID FK
        INTEGER DALI_NUM
        INTEGER SCENE_NUM
    }

    LUMINAIRES {
        INTEGER ID PK
        TEXT NAME
        INTEGER ICO_NUM
        INTEGER POS_X
        INTEGER POS_Y
        TEXT EXIST
        INTEGER DALI_ADDR
        INTEGER LOCATION_ID FK
        INTEGER GROUP_ID FK
        INTEGER VAL_BRIGHT
        INTEGER VAL_TW
        INTEGER VAL_R
        INTEGER VAL_G
        INTEGER VAL_B
        INTEGER VAL_W
        INTEGER SCENE_NUM
    }

    SCENE_LUMINAIRES {
        INTEGER ID PK
        INTEGER SCENE_NUM
        INTEGER LUMINAIRE_ID FK
        INTEGER VAL_BRIGHT
        INTEGER VAL_TW
        INTEGER VAL_R
        INTEGER VAL_G
        INTEGER VAL_B
        INTEGER VAL_W
    }

    PRES_SENSORS {
        INTEGER ID PK
        TEXT NAME
        TEXT EXIST
        INTEGER DALI_ADDR
        INTEGER DALI_INST
        INTEGER LOCATION_ID FK
        INTEGER ACTION_OCCUPANCY_ID FK
        INTEGER ACTION_VACANCY_ID FK
        INTEGER DELAY
    }

    BRIGHT_SENSORS {
        INTEGER ID PK
        TEXT NAME
        TEXT EXIST
        INTEGER DALI_ADDR
        INTEGER DALI_INST
        INTEGER LOCATION_ID FK
        INTEGER GROUP_ID FK
    }

    BUTTON_PANELS {
        INTEGER ID PK
        TEXT NAME
        TEXT EXIST
        INTEGER DALI_ADDR
        INTEGER LOCATION_ID FK
    }

    BUTTONS {
        INTEGER ID PK
        TEXT NAME
        TEXT EXIST
        INTEGER BUTTON_PANEL_ID FK
        INTEGER DALI_INST
        INTEGER ACTION_SET_SHORT_ID FK
        INTEGER ACTION_LONG_ID FK
    }

    ACTIONS {
        INTEGER ID PK
        TEXT EXIST
        INTEGER ACTION_SET_ID FK
        INTEGER POS
    }

    ACTION_SETS {
        INTEGER ID PK
        TEXT EXIST
    }

    SUBACTIONS {
        INTEGER ID PK
        TEXT EXIST
        INTEGER ACTION_ID FK
        INTEGER OBJECT_TYPE
        INTEGER OBJECT_NUM
        INTEGER VALUE
    }

    EVENTS {
        INTEGER ID PK
        TEXT EXIST
        TEXT DAYS
        TEXT TIME
        TEXT SMOOTH
        INTEGER ACTION_SET_ID FK
    }
```
