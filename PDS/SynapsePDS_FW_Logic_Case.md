# Прошивка. Логика работы. Корпус контроллера

АПК Синапс v1.0. ПО. Спецификации на разработку

**Последнее изменение:** 12.12.2025, 12:46 МСК

## 1. Назначение документа

Описать логику работы элементов корпуса контроллера: железной кнопки и светодиодной индикации.

## 2. Базовые документы

- **SynapsePDS_FW_Logic** — базовые принципы логики работы прошивки
- **SynapsePDS_FW_DB** — структура базы данных прошивки

## 3. Корпус контроллера

### 3.1. Сброс контроллера железной кнопкой

#### 3.1.1. Короткое нажатие кнопки

3.1.1.1. Короткое нажатие сбрасывает только пароль к заводскому.

3.1.1.2. Прошивка:
- Считывает заводской пароль из области хранения констант;
- Записывает его в **CONTROLLERS.PASSWORD**.

3.1.1.3. Остальные данные FW-USM не изменяются.

#### 3.1.2. Долгое нажатие кнопки

3.1.2.1. Долгое нажатие сбрасывает все настройки прошивки (не исполняемый код) в заводское состояние.

3.1.2.2. Прошивка:
- Сбрасывает все данные FW-USM;
- Сбрасывает блок IDATA;
- Восстанавливает заводское имя: `SYNAPSE XXXXXXXX`;
- Восстанавливает заводской пароль;
- Восстанавливает дефолтную иконку (0).

3.1.2.3. После сброса контроллер требует инициализации линии DALI.

### 3.2. Индикация на контроллере

#### 3.2.1. Нижний светодиод

3.2.1.1. Нижний светодиод мигает, если идёт работа с линией DALI:
- Отправка команд устройствам;
- Чтение данных с устройств;
- Инициализация линии.

3.2.1.2. В остальное время светодиод не горит.

#### 3.2.2. Лесенка светодиодов

3.2.2.1. Лесенка светодиодов загорается вся, если есть хотя бы одно Bluetooth-соединение с телефоном.

3.2.2.2. Если нет подключённых телефонов — вся лесенка не горит.

3.2.2.3. Количество горящих светодиодов не отражает количество подключённых телефонов (только факт наличия хотя бы одного).

